= Pivotal CF Mobile Services Field Demo

This document outlines the steps required to demo Pivotal Cloud Foundry Mobile Services using the Transit Application.

=== Agenda
* Introduce Mobile Services on Cloud Foundry
* What we are going to see? Case for Microservices based architecture for Agile Mobile Application Delivery
* Transit App - Big Picture
* Demo
* What we saw ? Microservices based architecture for Agile Mobile App Delivery using Cloud Foundry
* Q/A


=== Introduce Mobile Services on Cloud Foundry

image:./images/PCF_MobileService.png[Mobile Services on Cloud Foundry]

*Data Sync*

Mobile Optimized API's for cloud based data storage service which can sync data across devices and uses federated (Oauth) identity.

*API Gateway*

Deliver mobile-optimized, device specific content from backend microservices on a cloud scale and manage the interface lifecycle through versioning.

*Push Notification*

Push Notification service at cloud scale and across platforms with granular control over the data, tags and devices.

*App Distribution*

Enable testers to easily download developer versions of apps over-the-air (OTA) to mobile devices and

For more detailed Technical Deck, refer to the pitch deck from Product Manager: link:https://drive.google.com/open?id=0B0FpBXIzbQ9pemtFQkowUzhmaG8&authuser=0[Mobile Pitch Deck]


=== What we are going to see?
==== Case for Microservices based architecture for Agile Mobile Application Delivery

Mobile app development brings new requirements and with it new challenges. 
Mobile Apps provide a new engagement model as they have to support new devices, new sensors and new user behaviour. Mobile Apps typically have 10-24 releases per year as new OS's,new devices,new requirements come in. Mobile apps have resulted in exponential and higly dynamic workloads with zero downtime. 

Mobile apps require a modern cloud architecture and platform which is highly scalable and secure with full control of data. 
Legacy backend systems can provide the enterprise data using Microservices on a enterprise cloud platform to serve the new Mobile first apps, which can  
- Scale up for dynamic workloads from Mobile Apps
- Organized around a business functionality, do one thing, well
- Independently developed, deployed and scaled without interdependency 
- Designed for failure

Resource : link:https://www.youtube.com/watch?v=xIXIFx22F98#t=328[The Mobile First World Deliver Mobile Apps Faster]

Gartner predicts that Emerging cloud mobile back-end services threaten to replace mobile middleware for
enterprise mobile app developers. As mBaaS services mature, the entry of general-purpose middleware and PaaS
vendors into the mobile market will expand the options for mobile development leaders and architects, resulting in best-in-class specialized cloud mobile services as opposed to bundles of services.

image:./images/Gartner.png[Mobile Services on Cloud Foundry]

For more details refer to the Gartner Research note here link:https://sites.google.com/a/pivotal.io/analyst-relations/agile-apps/gartner-thetransformationofmobilemiddleware-internal/The%20Transformation%20of%20Mobile%20Middleware.pdf?attredirects=0[Gartner Note]


Pivotal Labs has built 100's of Mobile Apps using these design principles of Microservices and delivered them on Pivotal Cloud Foundry. Dwayne Forde from the Cloud Foundry Mobile Services team at Pivotal discusses in this blog post link:http://blog.pivotal.io/cloud-foundry-pivotal/case-studies-2/how-pivotal-performs-continuous-delivery-of-mobile-services[How Pivotal Performs Continuous Delivery of Mobile Services] on Pivotal Cloud Foundry:

[quote]
"Continuous Integration (CI) and Continuous Delivery (CD) play a large role in Pivotalâ€™s agile engineering culture. 
Integration testing can be simulated in many different ways, but when it comes to Mobile Services, the only viable solution 
is to use real devices. We have implemented a method that offers an automated 360 view of our product quality throughout the 
development process, from the installation of a tile in Pivotal Cloud Foundry Ops Manager to delivery of end-user mobile 
applications that use products such as the Push Notification Service."


We are going to see how a sample mobile Transit App uses the Pivotal Cloud Foundry Mobile Services and Microservices based architecture. 

=== Transit App on Pivotal Cloud Foundry - Big Picture
==== The Transit Mobile App
The Transit App is a sample mobile application which shows the public transportation routes for the city of Toronto.
This app combines the Pivotal Cloud Foundry platform with the Pivotal Mobile Services, namely Data Sync, Push Notification
and Api Gateway to give a mobile user the ability to create bus routes of interest and receive push notifications based on
predictions.

image:./images/Transit-App-1.png[Transit App Architecture]


==== Components of Transit App: Client and Platform Apps and Microservices

image:./images/Transit App Architecture.png[Transit App Architecture]


The transit application consist of the following components:

==== Transit Application
The transit mobile application provides a simple way to register for bus routes of interest and receive notifications when
a route is predicted to route late. The application authenicates users after launch using the data synch authenication service and retrieves existing user-saved bus routes from the data synch mobile service. There is native applicaiton for iOS and Android devices.

==== Transit Sample API Gateway
The transit sample API gateway application makes external web service calls to the NextBus web service and performs XML->JSON
translation. This application is deployed into Pivotal Cloud Foundry into an organization and space is and bound to the API Gateway service. The demo environment already has this application deployed.

==== Transit Sample Scheduler
The transit sample scheduler application is a ruby based application that reviews the stop predictions and sends push notifications to mobile users that registered with those bus routes. The demo environment already has this application deployed.

==== NextBus Web Service
link:http://www.nextbus.com/predictor/stopSelector.jsp?a=ttc[NextBus] is a third party web service which delivers a list of bus routes, service alerts and predictions. It is used by the API Gateway to retrieve service information about mobile user routes.


=== Demo


==== Demo Environment
The demo environment has the following Pivotal products installed and ready for you to demo. This environment is typically the latest GA products and is pre-confogured with the external vender services like Apple Push Notification Service (APNS) and Google OAuth. 

User/Password: demo/mobiledemo@123

* link:https://opsmgr.mobile.piv-demo.com[Pivotal Operations Manager]
* link:https://console.mobile.piv-demo.com[Pivotal Cloud Foundry (Elastic Runtime)]
* link:http://datasync-dashboard.mobile.piv-demo.com/metrics[Pivotal Data Synch]
* link:http://gs-dashboard.mobile.piv-demo.com[Pivotal API Gateway]
* link:http://push-notifications-dashboard.mobile.piv-demo.com[Pivotal Push Notification]

==== Steps:


Use link:http://www.tekrevue.com/tip/record-iphone-screen-quicktime[QuickTime Movie]  or link:http://www.airsquirrels.com/reflector/[Reflector] to demo the App from your Laptop. 

[NOTE]
For Reflector you have to be on the same network and without firewall's blocking the reflector airplay ports. Refer to the documentation link:http://help.airsquirrels.com/support/solutions/articles/1000107197-i-can-t-see-the-airplay-icon-on-my-device-[here]


===== Launch the App and Authenticate using Google. 

image:./images/Transit-App-2.png[Launch,scaledheight=30%]


Data sync service uses the Oauth token to create a datastorge on the cloud for the customer.The Application home page shows the list of Routes you are interested in getting notified on. 



===== Add Notification (to and From)

Register for Push Notification and add a route to be notified. The scheduler app checks the likelihood of a bus arriving at a destination based on the Next Web Service and notifies the devices registered for notification.

image:./images/Transit-App-3.png[Add Route,scaledheight=30%]

===== Delete or Unsubscribe Notification and Logout

To delete a Route, swipe the Route left, and you will see the delete button. To unsubscribe, slide the radio button to off. 


image:./images/Transit-App-4.png[Clear Route,scaledheight=30%]

=== Behind the scenes - Microservices on the cloud platform
The Transit mobile backend uses various Pivotal mobile services on the Pivotal Cloud Foundry Platform. 

image:./images/Transit-App-5.png[Mobile Backend Design,scaledheight=30%]


==== Datasync
The Mobile App uses the Pivotal Data-sync mobile services to save user preferences, routes across devices. 

image:./images/Transit-App-6.png[Mobile Data-sync Workflow,scaledheight=30%]


image:./images/Transit-App-10.png[Mobile Data-sync Services on Pivotal Cloud Foundry,scaledheight=30%]


==== API Gateway

image:./images/Transit-App-7.png[API Gateway Workflow,scaledheight=30%]

image:./images/Transit-App-8.png[NextBus Transformation,scaledheight=30%]


==== Push Notification
Pivotal Cloud Foundry Push Notification Dashboards and Services

image:./images/Transit-App-9.png[Push Notification Workflow,scaledheight=30%]

image:./images/Transit-App-11.png[Push Notification Services,scaledheight=30%]


image:./images/Transit-App-16.png[Test Push Message,scaledheight=30%]


==== Ops Manager
Pivotal Cloud Foundry Ops Manager Configuration for Mobile Services

image:./images/Transit-App-15.png[Ops Manager,scaledheight=30%]


=== What we saw today ...
==== Microservices based architecture for Agile Mobile App Delivery using Cloud Foundry

=== Q/A
